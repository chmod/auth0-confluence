<?xml version="1.0" encoding="UTF-8"?>

<atlassian-plugin key="${atlassian.plugin.key}" name="${project.name}"
	plugins-version="2">
	<plugin-info>
		<description>${project.description}</description>
		<version>${project.version}</version>
		<vendor name="${project.organization.name}" url="${project.organization.url}" />
		<param name="plugin-icon">images/pluginIcon.png</param>
		<param name="plugin-logo">images/pluginLogo.png</param>
	</plugin-info>
	<!-- add our i18n resource -->
	<resource type="i18n" name="i18n" location="auth0i18n" />
	<!-- add our web resources -->
	<web-resource key="auth0-resources" name="auth0 Web Resources">
		<dependency>com.atlassian.auiplugin:ajs</dependency>
		<resource type="download" name="auth0.css" location="/css/auth0.css" />
		<resource type="download" name="auth0.js" location="/js/auth0.js" />
		<resource type="download" name="images/" location="/images" />
		<context>auth0-base-resources</context>
	</web-resource>
	<!-- Auth0 Configuration -->
	<servlet-context-param key="auth-domain">
		<param-name>auth0.domain</param-name>
		<param-value>sxwdc-non-prod.auth0.com</param-value>
	</servlet-context-param>
	<servlet-context-param key="auth-client_id">
		<param-name>auth0.client_id</param-name>
		<param-value>15eNGTm5Y5ZQNzuSDbWVNrpGpdDEWwvn</param-value>
	</servlet-context-param>
	<servlet-context-param key="auth-client_secret">
		<param-name>auth0.client_secret</param-name>
		<param-value>poxYjy4eLFUmHkjiNUoz5VKPialBDuYcwZhTTGHyC7jS7srN_S0mTKq6BjZ03HsF
		</param-value>
	</servlet-context-param>

	<!-- Servlet Configuration -->
	<servlet name="Auth0" i18n-name-key="auth.name" key="auth"
		class="dk.schneiderelectric.dcimteam.servlet.LoginServletCallback">
		<description>Auth0 test servlet</description>
		<url-pattern>/callback</url-pattern>
		<init-param>
			<param-name>auth0.redirect_on_success</param-name>
			<param-value>/</param-value>
		</init-param>
		<init-param>
			<param-name>auth0.redirect_on_error</param-name>
			<param-value>/plugins/servlet/login</param-value>
		</init-param>
	</servlet>

	<xwork name="Login Override Action" key="loginOverride">
		<package name="loginDefault" extends="default">
			<interceptor-ref name="defaultStack" />
			<action name="login"
				class="dk.schneiderelectric.dcimteam.auth0.impl.LoginPresenter">
				<result name="success" type="velocity">/templates/loginView.vm</result>
			</action>
			<action name="loginlocal"
				class="dk.schneiderelectric.dcimteam.auth0.impl.LoginLocal" method="doDefault">
				<interceptor-ref name="validatingStack" />
				<result name="input" type="velocity">/templates/loginLocal.vm</result>
			</action>
			<action name="dologinlocal"
				class="dk.schneiderelectric.dcimteam.auth0.impl.LoginLocal">
				<interceptor-ref name="validatingStack" />
				<result name="input" type="velocity">/templates/loginLocal.vm</result>
				<result name="error" type="velocity">/templates/loginLocal.vm</result>
				<result name="success" type="velocity">/templates/loginLocal.vm</result>
			</action>
		</package>
	</xwork>

	<routing key="${project.artifactId}-routes" path="/auth0">
		<route from="/login" to="/auth/login.action" />
		<!-- <route from="/callback" to="/devices/overview.action" /> -->
	</routing>


</atlassian-plugin>
